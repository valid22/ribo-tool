<html><head>
        <title>Riboswitch: DNA annotation</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <style>/* ! tailwindcss v3.2.4 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}[type='text'],[type='email'],[type='url'],[type='password'],[type='number'],[type='date'],[type='datetime-local'],[type='month'],[type='search'],[type='tel'],[type='time'],[type='week'],[multiple],textarea,select{-webkit-appearance:none;appearance:none;background-color:#fff;border-color:#6b7280;border-width:1px;border-radius:0px;padding-top:0.5rem;padding-right:0.75rem;padding-bottom:0.5rem;padding-left:0.75rem;font-size:1rem;line-height:1.5rem;--tw-shadow:0 0 #0000;}[type='text']:focus, [type='email']:focus, [type='url']:focus, [type='password']:focus, [type='number']:focus, [type='date']:focus, [type='datetime-local']:focus, [type='month']:focus, [type='search']:focus, [type='tel']:focus, [type='time']:focus, [type='week']:focus, [multiple]:focus, textarea:focus, select:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);border-color:#2563eb}input::placeholder,textarea::placeholder{color:#6b7280;opacity:1}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-date-and-time-value{min-height:1.5em}::-webkit-datetime-edit,::-webkit-datetime-edit-year-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-meridiem-field{padding-top:0;padding-bottom:0}select{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right 0.5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem;print-color-adjust:exact}[multiple]{background-image:initial;background-position:initial;background-repeat:unset;background-size:initial;padding-right:0.75rem;print-color-adjust:unset}[type='checkbox'],[type='radio']{-webkit-appearance:none;appearance:none;padding:0;print-color-adjust:exact;display:inline-block;vertical-align:middle;background-origin:border-box;-webkit-user-select:none;user-select:none;flex-shrink:0;height:1rem;width:1rem;color:#2563eb;background-color:#fff;border-color:#6b7280;border-width:1px;--tw-shadow:0 0 #0000}[type='checkbox']{border-radius:0px}[type='radio']{border-radius:100%}[type='checkbox']:focus,[type='radio']:focus{outline:2px solid transparent;outline-offset:2px;--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:2px;--tw-ring-offset-color:#fff;--tw-ring-color:#2563eb;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow)}[type='checkbox']:checked,[type='radio']:checked{border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}[type='checkbox']:checked{background-image:url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e")}[type='radio']:checked{background-image:url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e")}[type='checkbox']:checked:hover,[type='checkbox']:checked:focus,[type='radio']:checked:hover,[type='radio']:checked:focus{border-color:transparent;background-color:currentColor}[type='checkbox']:indeterminate{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 16 16'%3e%3cpath stroke='white' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 8h8'/%3e%3c/svg%3e");border-color:transparent;background-color:currentColor;background-size:100% 100%;background-position:center;background-repeat:no-repeat}[type='checkbox']:indeterminate:hover,[type='checkbox']:indeterminate:focus{border-color:transparent;background-color:currentColor}[type='file']{background:unset;border-color:inherit;border-width:0;border-radius:0;padding:0;font-size:unset;line-height:inherit}[type='file']:focus{outline:1px solid ButtonText;outline:1px auto -webkit-focus-ring-color}*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::-webkit-backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.absolute{position:absolute}.relative{position:relative}.inset-0{top:0px;right:0px;bottom:0px;left:0px}.left-0{left:0px}.bottom-0{bottom:0px}.right-0{right:0px}.top-5{top:1.25rem}.right-5{right:1.25rem}.z-10{z-index:10}.mx-auto{margin-left:auto;margin-right:auto}.mx-4{margin-left:1rem;margin-right:1rem}.mr-2{margin-right:0.5rem}.mr-3{margin-right:0.75rem}.mb-2{margin-bottom:0.5rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.-ml-2{margin-left:-0.5rem}.-mb-1{margin-bottom:-0.25rem}.-mr-1{margin-right:-0.25rem}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-4{height:1rem}.h-full{height:100%}.h-48{height:12rem}.h-12{height:3rem}.h-96{height:24rem}.w-4{width:1rem}.w-full{width:100%}.w-48{width:12rem}.flex-shrink{flex-shrink:1}.flex-grow{flex-grow:1}.origin-top-right{transform-origin:top right}.-translate-x-full{--tw-translate-x:-100%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-12{--tw-translate-y:3rem;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-rotate-90{--tw-rotate:-90deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.content-center{align-content:center}.items-center{align-items:center}.items-baseline{align-items:baseline}.justify-between{justify-content:space-between}.gap-x-8{column-gap:2rem}.gap-y-10{row-gap:2.5rem}.overflow-hidden{overflow:hidden}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.border-4{border-width:4px}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity))}.border-gray-400{--tw-border-opacity:1;border-color:rgb(156 163 175 / var(--tw-border-opacity))}.border-gray-900{--tw-border-opacity:1;border-color:rgb(17 24 39 / var(--tw-border-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39 / var(--tw-bg-opacity))}.p-4{padding:1rem}.p-2\.5{padding:0.625rem}.p-2{padding:0.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-2\.5{padding-left:0.625rem;padding-right:0.625rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-0{padding-top:0px;padding-bottom:0px}.pt-24{padding-top:6rem}.pb-6{padding-bottom:1.5rem}.pt-6{padding-top:1.5rem}.pb-24{padding-bottom:6rem}.pt-12{padding-top:3rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.font-medium{font-weight:500}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39 / var(--tw-text-opacity))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity))}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-300{transition-duration:300ms}.duration-200{transition-duration:200ms}.ease-out{transition-timing-function:cubic-bezier(0, 0, 0.2, 1)}.ease-linear{transition-timing-function:linear}.focus\:border-blue-500:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity))}.focus\:border-indigo-500:focus{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity))}.focus\:ring-indigo-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(99 102 241 / var(--tw-ring-opacity))}.group:hover .group-hover\:mb-0{margin-bottom:0px}.group:hover .group-hover\:mr-0{margin-right:0px}.group:hover .group-hover\:-rotate-180{--tw-rotate:-180deg;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}@media (prefers-color-scheme: dark){.dark\:bg-blue-200{--tw-bg-opacity:1;background-color:rgb(191 219 254 / var(--tw-bg-opacity))}.dark\:text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity))}}@media (min-width: 640px){.sm\:text-sm{font-size:0.875rem;line-height:1.25rem}}@media (min-width: 1024px){.lg\:col-span-3{grid-column:span 3 / span 3}.lg\:block{display:block}.lg\:h-full{height:100%}.lg\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}}</style><style>@import url(https://fonts.googleapis.com/css?family=Roboto+Mono:300,400,500&display=swap);</style><style>/* Shared/common settings */
.la-vz-seqviz {
  height: 100%;
  width: 100%;
}

.la-vz-seqviz svg {
  overflow: visible !important;
}

.la-vz-seqviz svg text {
  fill: rgb(42, 42, 42);
  font-family: Roboto Mono, Monaco, monospace;
  user-select: none;

  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.la-vz-seqviz svg text:selection {
  background: none;
}

.la-vz-viewer-container {
  height: 100%;
  width: 100%;
  position: relative;
}

.la-vz-viewer-event-router {
  display: flex;
  flex-direction: row;
  position: absolute;
  outline: none;
  height: 100%;
  width: 100%;
}

.la-vz-search {
  fill: rgba(255, 251, 7, 0.5);
}

.la-vz-highlight {
  fill: rgba(255, 251, 7, 0.25);
}

.la-vz-selection {
  fill: rgb(222, 246, 255);
}

.la-vz-selection-edge {
  fill: transparent;
  shape-rendering: geometricPrecision;
  stroke: black;
  fill: black;
}

.la-vz-cut-site {
  fill: transparent;
  stroke: black;
  stroke-width: 1;
  shape-rendering: auto;
}

.la-vz-cut-site-text {
  font-size: 13px;
  cursor: pointer;
}

.la-vz-index-line {
  shape-rendering: geometricPrecision;
  fill: transparent;
  stroke: rgb(115, 119, 125);
  stroke-width: 1;
}

.la-vz-index-tick {
  fill: transparent;
  shape-rendering: geometricPrecision;
  stroke: rgb(115, 119, 125);
  stroke-width: 1;
}

.la-vz-index-tick-label {
  font-weight: 300;
  fill: rgb(115, 119, 125);
  text-rendering: optimizeLegibility;
}

.la-vz-annotation {
  shape-rendering: geometricPrecision;
  fill-opacity: 0.7;
  stroke-width: 0.5;
}

.la-vz-annotation-label {
  color: rgb(42, 42, 42);
  font-weight: 400;
  shape-rendering: geometricPrecision;
  stroke-linejoin: round;
  text-rendering: optimizeLegibility;
}

/* Circular Viewer */
.la-vz-viewer-circular {
  margin: auto;
  font-size: 13px;
  font-weight: 300;
  cursor: text;
}

.la-vz-circular-label {
  cursor: pointer;
}

.la-vz-circular-label:hover {
  text-decoration: underline;
}

.la-vz-label-line {
  stroke: rgb(158, 170, 184);
  stroke-width: 1;
  fill: none;
}

/* Linear Viewer */
.la-vz-linear-scroller {
  height: 100%;

  outline: none !important;
  position: relative;
  font-weight: 300;
  padding: 10px;
  overflow-x: hidden;
  overflow-y: scroll;
  cursor: text;
}

.la-vz-seqblock-container {
  width: 100%;
}

.la-vz-seqblock {
  width: 100%;
  padding: 0;
  /* this is for when very zoomed out and the bp index disappears beneath the next block */
  overflow: visible;
}

.la-vz-scroll::-webkit-scrollbar {
  width: 7px;
}

.la-vz-scroll::-webkit-scrollbar-thumb {
  background-clip: padding-box;
  border-radius: 7px;
  background-color: rgb(166, 166, 166);
}

.la-vz-scroll::-webkit-scrollbar-track {
  border-radius: 20px;
}

.la-vz-scroll::-webkit-scrollbar-track-piece {
  background-clip: padding-box;
  border-radius: 7px;
  background-color: rgb(236, 236, 236);
}
</style></head>

    <body>

        <div class="bg-white">
            <div>
              
              
          
              <main class="mx-auto px-4">
                <h1 class="text-4xl font-bold tracking-tight text-gray-900">CompBio Lab
</h1><div class="flex items-baseline justify-between border-b border-gray-200 pt-12 pb-6">
                   
<h1 class="text-4xl font-bold tracking-tight text-gray-900">
                    Riboswitch annotation tool
                    <span class="bg-blue-100 text-blue-800 text-xl font-semibold mr-2 px-2.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 hidden" id="annot-notif"> 
                      <svg role="status" class="inline mr-3 mb-2 w-4 h-4 text-white animate-spin" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="#E5E7EB"></path>
                        <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="#1C64F2"></path>
                        </svg>
                      <span id="annot-text">Annotating: {name} - {1}/{no}</span>
                    </span>
                  </h1>
          
                  
                </div>
          
                <section aria-labelledby="products-heading" class="pt-6 pb-24">
          
                  <div class="grid grid-cols-1 gap-x-8 gap-y-10 lg:grid-cols-4">
                    <!-- Filters -->
                    <div class="lg:block">
                      <!-- Replace with your content -->
                      <div class="p-4 rounded-lg border-4 border-dashed border-gray-200 h-full">
                        <h2 class="block text-xl font-medium text-gray-700">DNA sequence</h2>                          
                        <br>
                          <div>                            
                            <label class="block mb-2 text-sm font-medium text-gray-900 " for="file_input">Parse from a file</label>
                            <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none " aria-describedby="file_input_help" id="file_input" type="file" onchange="parse_file()">
                            <p class="mt-1 text-sm text-gray-500" id="file_input_help">Upload a GenBank, FASTA, JBEI, SnapGene, or SBOL file to parse sequence from it.</p>
                          </div>
                          <select id="sequence-list" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 mt-2" onchange="select_sequence()">
                            <option selected="" disabled="">Select a sequence</option>
                            
                            
                            
                            
                          </select>
                          <div class="relative flex py-5 items-center">
                            <div class="flex-grow border-t border-gray-400"></div>
                            <span class="flex-shrink mx-4 text-gray-400">or</span>
                            <div class="flex-grow border-t border-gray-400"></div>
                          </div>

                          <div>
                            <label for="about" class="block text-sm font-medium text-gray-700">DNA sequence from text</label>
                            <div class="mt-1">
                              <textarea id="dna_sequence_text" name="about" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="tcgcgcgtttcggtgatgacggtgaaaacctctgacacatgca">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGCTGGCCCCGTGGGAGAGACCGGTCTTGTGACCGGCGCCGAAGGCGCAACACCGCCCGGAATCGCTCAGGCAAAAGGACCGTGGGGCCAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCCTGTCGCTAGGGGTGCCCCCGTCAAGGGGCTGAGACGGCCGTGAAGCGGCCAACCCTCGGAACCTGAACCGGTTAATACCGGCGGAGGGAAGCGGCGGGCGCCCCACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGCTGGCCCCGTGGGAGAGACCGGTCTTGTGACCGGCGCCGAAGGCGCAACACCGCCCGGAATCGCTCAGGCAAAAGGACCGTGGGGCCAATCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCTGTCGCTAGGGGTGCCCCCGTCAAGGGGCTGAGACGGCCGTGAAGCGGCCAACCCTCGGAACCTGAACCGGTTAATACCGGCGGAGGGAAGCGGCGGGCGCCCCAC</textarea>
                            </div>
                            <p class="mt-2 text-sm text-gray-500">Copy paste the DNA sequence in the textarea above. <b>This will be given preference over file.</b></p>
                          </div>
                          <br>
                          <div class="content-center">
                            <a href="#_" class="relative inline-block text-sm group" onclick="annotate_sequence()">
                                <span class="relative z-10 block px-5 py-3 overflow-hidden font-medium leading-tight text-gray-800 transition-colors duration-300 ease-out border-2 border-gray-900 rounded-lg group-hover:text-white">
                                <span class="absolute inset-0 w-full h-full px-5 py-3 rounded-lg bg-gray-50"></span>
                                <span class="absolute left-0 w-48 h-48 -ml-2 transition-all duration-300 origin-top-right -rotate-90 -translate-x-full translate-y-12 bg-gray-900 group-hover:-rotate-180 ease"></span>
                                <span class="relative">Annotate DNA</span>
                                </span>
                                <span class="absolute bottom-0 right-0 w-full h-12 -mb-1 -mr-1 transition-all duration-200 ease-linear bg-gray-900 rounded-lg group-hover:mb-0 group-hover:mr-0" data-rounded="rounded-lg"></span>
                            </a>
                          </div>
                        </div>
                    </div>
          
                    <!-- Product grid -->
                    <div class="lg:col-span-3">
                      <!-- Replace with your content -->
                      <div class="h-96 rounded-lg border-4 border-dashed border-gray-200 lg:h-full">
                        <div id="root"><div class="la-vz-seqviz" data-testid="la-vz-seqviz" style="height: 500px;"><div class="la-vz-viewer-container" data-testid="la-vz-viewer-container"><div class="la-vz-viewer-event-router" id="la-vz-event-router" role="presentation" tabindex="-1"><svg class="la-vz-viewer-circular" data-testid="la-vz-viewer-circular" height="500" id="la-vz-L09136-viewer-circular" width="462.3984375"><g class="la-vz-circular-root" transform="translate(0, 0)"><g>0<path class="la-vz-selection-edge" d="M 231.19921875 134.78453125
			L 231.19921875 47.784531249999986" stroke-width="1" transform="rotate(200.93023255813952, 231.19921875, 250)"></path>0</g><g><text font-size="20" font-weight="500" text-anchor="middle"><tspan x="231.19921875" y="250">L09136</tspan></text><text x="231.19921875" y="264" fill="gray" font-size="14" text-anchor="middle">43 bp</text><g class="la-vz-circular-bps"><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-58.6046511627907, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-58.6046511627907, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-50.23255813953488, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-50.23255813953488, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-41.860465116279066, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-41.860465116279066, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-33.48837209302326, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-33.48837209302326, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-25.11627906976744, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-25.11627906976744, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-16.74418604651163, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-16.74418604651163, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(-8.372093023255815, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(-8.372093023255815, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(0, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(0, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(8.372093023255815, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(8.372093023255815, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(16.74418604651163, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(16.74418604651163, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(25.11627906976744, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(25.11627906976744, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(33.48837209302326, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(33.48837209302326, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(41.860465116279066, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(41.860465116279066, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(50.23255813953488, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(50.23255813953488, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(58.6046511627907, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(58.6046511627907, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(66.97674418604652, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(66.97674418604652, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(75.34883720930233, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(75.34883720930233, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(83.72093023255813, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(83.72093023255813, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(92.09302325581396, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(92.09302325581396, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(100.46511627906976, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(100.46511627906976, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(108.83720930232558, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(108.83720930232558, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(117.2093023255814, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(117.2093023255814, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(125.58139534883722, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(125.58139534883722, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(133.95348837209303, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(133.95348837209303, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(142.32558139534882, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(142.32558139534882, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(150.69767441860466, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(150.69767441860466, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(159.06976744186048, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(159.06976744186048, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(167.44186046511626, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(167.44186046511626, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(175.81395348837208, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(175.81395348837208, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(184.18604651162792, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(184.18604651162792, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(192.5581395348837, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(192.5581395348837, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(200.93023255813952, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(200.93023255813952, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(209.30232558139537, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(209.30232558139537, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(217.67441860465115, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(217.67441860465115, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(226.04651162790697, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(226.04651162790697, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(234.4186046511628, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(234.4186046511628, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(242.7906976744186, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(242.7906976744186, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(251.16279069767444, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(251.16279069767444, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(259.5348837209302, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(259.5348837209302, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(267.90697674418607, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(267.90697674418607, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(276.27906976744185, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(276.27906976744185, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(284.65116279069764, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(284.65116279069764, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(293.0232558139535, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(293.0232558139535, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(301.3953488372093, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(301.3953488372093, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(309.7674418604651, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(309.7674418604651, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(318.13953488372096, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(318.13953488372096, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(326.51162790697674, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(326.51162790697674, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(334.8837209302325, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(334.8837209302325, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(343.25581395348837, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(343.25581395348837, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(351.62790697674416, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(351.62790697674416, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(360, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(360, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(368.37209302325584, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(368.37209302325584, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(376.7441860465117, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(376.7441860465117, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(385.1162790697674, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(385.1162790697674, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(393.48837209302326, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(393.48837209302326, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(401.86046511627904, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(401.86046511627904, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(410.2325581395349, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(410.2325581395349, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(418.60465116279073, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(418.60465116279073, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(426.9767441860466, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(426.9767441860466, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(435.3488372093023, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(435.3488372093023, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(443.72093023255815, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(443.72093023255815, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(452.09302325581393, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(452.09302325581393, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(460.4651162790698, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(460.4651162790698, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(468.8372093023256, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(468.8372093023256, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(477.20930232558135, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(477.20930232558135, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(485.5813953488372, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(485.5813953488372, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(493.95348837209303, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(493.95348837209303, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(502.3255813953489, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(502.3255813953489, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(510.69767441860466, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(510.69767441860466, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(519.0697674418604, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(519.0697674418604, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(527.4418604651163, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(527.4418604651163, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(535.8139534883721, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(535.8139534883721, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(544.1860465116279, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(544.1860465116279, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(552.5581395348837, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(552.5581395348837, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(560.9302325581396, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(560.9302325581396, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(569.3023255813953, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(569.3023255813953, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(577.6744186046511, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(577.6744186046511, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(586.046511627907, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(586.046511627907, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(594.4186046511628, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(594.4186046511628, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(602.7906976744187, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(602.7906976744187, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(611.1627906976744, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(611.1627906976744, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(619.5348837209302, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(619.5348837209302, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(627.9069767441861, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(627.9069767441861, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(636.2790697674419, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(636.2790697674419, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(644.6511627906978, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(644.6511627906978, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(653.0232558139535, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(653.0232558139535, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(661.3953488372093, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(661.3953488372093, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(669.767441860465, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(669.767441860465, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(678.1395348837209, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(678.1395348837209, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(686.5116279069767, 231.19921875, 250)">t</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(686.5116279069767, 231.19921875, 250)">a</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(694.8837209302326, 231.19921875, 250)">g</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(694.8837209302326, 231.19921875, 250)">c</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(703.2558139534883, 231.19921875, 250)">c</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(703.2558139534883, 231.19921875, 250)">g</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(711.6279069767442, 231.19921875, 250)">a</text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(711.6279069767442, 231.19921875, 250)">t</text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(720, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(720, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(728.3720930232558, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(728.3720930232558, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(736.7441860465117, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(736.7441860465117, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(745.1162790697675, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(745.1162790697675, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(753.4883720930234, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(753.4883720930234, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(761.8604651162791, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(761.8604651162791, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(770.2325581395348, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(770.2325581395348, 231.19921875, 250)"></text><text x="231.19921875" y="64.78453124999999" dominant-baseline="middle" transform="rotate(778.6046511627907, 231.19921875, 250)"></text><text x="231.19921875" y="78.78453124999999" dominant-baseline="middle" transform="rotate(778.6046511627907, 231.19921875, 250)"></text></g><g transform="rotate(4.186046511627907, 231.19921875, 250)"><path class="la-vz-index-tick" d="M 231.19921875 92.78453124999999 L 231.19921875 99.78453124999999"></path><text class="la-vz-index-tick-label" font-size="11" text-anchor="middle" x="231.19921875" y="113.78453124999999">1</text></g><g transform="rotate(79.53488372093024, 231.19921875, 250)"><path class="la-vz-index-tick" d="M 231.19921875 92.78453124999999 L 231.19921875 99.78453124999999"></path><text class="la-vz-index-tick-label" font-size="11" text-anchor="middle" x="231.19921875" y="113.78453124999999">10</text></g><g transform="rotate(163.25581395348837, 231.19921875, 250)"><path class="la-vz-index-tick" d="M 231.19921875 92.78453124999999 L 231.19921875 99.78453124999999"></path><text class="la-vz-index-tick-label" font-size="11" text-anchor="middle" x="231.19921875" y="113.78453124999999">20</text></g><g transform="rotate(246.97674418604652, 231.19921875, 250)"><path class="la-vz-index-tick" d="M 231.19921875 92.78453124999999 L 231.19921875 99.78453124999999"></path><text class="la-vz-index-tick-label" font-size="11" text-anchor="middle" x="231.19921875" y="113.78453124999999">30</text></g><g><path class="la-vz-index-line" d="M 231.19921875 407.21546875
      A 157.21546875 157.21546875, 0, 1, 1, 231.19921875 92.78453124999999
      L 231.19921875 92.78453124999999
      
      L 231.19921875 92.78453124999999
      A 157.21546875 157.21546875, 0, 1, 0, 231.19921875 407.21546875
      
      Z" transform="rotate(270, 231.19921875, 250)"></path><path class="la-vz-index-line" d="M 231.19921875 407.21546875
      A 157.21546875 157.21546875, 0, 1, 1, 231.19921875 92.78453124999999
      L 231.19921875 92.78453124999999
      
      L 231.19921875 92.78453124999999
      A 157.21546875 157.21546875, 0, 1, 0, 231.19921875 407.21546875
      
      Z" transform="rotate(90, 231.19921875, 250)"></path></g></g><g class="la-vz-circular-search"></g><g class="la-vz-circular-annotations"></g><g class="la-vz-circular-labels"></g></g></svg><div class="la-vz-linear-scroller" data-testid="la-vz-viewer-linear"><div class="la-vz-seqblock-container" style="height: 65.1px;"><div class="la-vz-seqblock-padding-top" style="height: 0px; width: 0px;"></div><svg class="la-vz-seqblock" cursor="text" display="block" height="65.1" id="tcgcgcgtttcggtgatgacggtgaaaacctctgacacatgca0" width="462.3984375"><g transform="translate(0, 21)"><path class="la-vz-index-line" d="M 0 1 L 463.3984375 1"></path><path class="la-vz-index-tick" d="M 0 0 L 0 7" transform="translate(6.37672601744186, 1)"></path><text class="la-vz-index-tick-label" dominant-baseline="hanging" font-size="11" transform="translate(4.37672601744186, 10)">1</text><path class="la-vz-index-tick" d="M 0 0 L 0 7" transform="translate(103.15779433139534, 1)"></path><text class="la-vz-index-tick-label" dominant-baseline="hanging" font-size="11" transform="translate(97.30779433139534, 10)">10</text><path class="la-vz-index-tick" d="M 0 0 L 0 7" transform="translate(210.69231468023253, 1)"></path><text class="la-vz-index-tick-label" dominant-baseline="hanging" font-size="11" transform="translate(204.84231468023253, 10)">20</text><path class="la-vz-index-tick" d="M 0 0 L 0 7" transform="translate(318.2268350290697, 1)"></path><text class="la-vz-index-tick-label" dominant-baseline="hanging" font-size="11" transform="translate(312.3768350290697, 10)">30</text><path class="la-vz-index-tick" d="M 0 0 L 0 7" transform="translate(425.76135537790697, 1)"></path><text class="la-vz-index-tick-label" dominant-baseline="hanging" font-size="11" transform="translate(419.91135537790694, 10)">40</text></g><g><rect class="la-vz-selection-edge" data-testid="la-vz-selection-edge" height="35" stroke-width="0" width="1" x="259.08284883720927" y="-5"></rect><rect class="la-vz-selection-edge" data-testid="la-vz-selection-edge" height="35" stroke-width="0" width="1" x="259.08284883720927" y="-5"></rect></g>00<text dominant-baseline="hanging" font-size="15" lengthAdjust="spacing" text-anchor="start" textLength="462.3984375" text-rendering="optimizeLegibility" class="la-vz-seq" data-testid="la-vz-seq" id="tcgcgcgtttcggtgatgacggtgaaaacctctgacacatgca0" y="0"><tspan x="2.1506904069767443">t</tspan><tspan x="12.904142441860465">c</tspan><tspan x="23.657594476744183">g</tspan><tspan x="34.4110465116279">c</tspan><tspan x="45.16449854651162">g</tspan><tspan x="55.917950581395345">c</tspan><tspan x="66.67140261627907">g</tspan><tspan x="77.42485465116279">t</tspan><tspan x="88.17830668604651">t</tspan><tspan x="98.93175872093023">t</tspan><tspan x="109.68521075581396">c</tspan><tspan x="120.43866279069768">g</tspan><tspan x="131.19211482558137">g</tspan><tspan x="141.9455668604651">t</tspan><tspan x="152.69901889534881">g</tspan><tspan x="163.45247093023255">a</tspan><tspan x="174.20592296511626">t</tspan><tspan x="184.95937499999997">g</tspan><tspan x="195.7128270348837">a</tspan><tspan x="206.4662790697674">c</tspan><tspan x="217.21973110465115">g</tspan><tspan x="227.97318313953485">g</tspan><tspan x="238.7266351744186">t</tspan><tspan x="249.4800872093023">g</tspan><tspan x="260.23353924418603">a</tspan><tspan x="270.98699127906974">a</tspan><tspan x="281.7404433139535">a</tspan><tspan x="292.4938953488372">a</tspan><tspan x="303.2473473837209">c</tspan><tspan x="314.00079941860463">c</tspan><tspan x="324.7542514534884">t</tspan><tspan x="335.5077034883721">c</tspan><tspan x="346.2611555232558">t</tspan><tspan x="357.0146075581395">g</tspan><tspan x="367.7680595930232">a</tspan><tspan x="378.521511627907">c</tspan><tspan x="389.2749636627907">a</tspan><tspan x="400.0284156976744">c</tspan><tspan x="410.7818677325581">a</tspan><tspan x="421.5353197674419">t</tspan><tspan x="432.2887718023256">g</tspan><tspan x="443.0422238372093">c</tspan><tspan x="453.795675872093">a</tspan></text></svg></div></div></div></div></div></div>
                      </div>
                      <!-- /End replace -->
                    </div>
                  </div>
                </section>

<div class="text-2 tracking-tight text-gray-900">
    <p>Guide: <i>Ashok Palaniappan</i></p>
    <p><i>Krittika N, Mridula G, Vigneshwaran</i></p>
    
    
</div>
              </main>
            </div>
          </div>

          <div class="toast-panel absolute top-5 right-5" id="toasts">
            
          </div>
          
        <script src="https://unpkg.com/seqviz"></script>
        <script src="https://unpkg.com/bio-parsers/umd/bio-parsers.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js" integrity="sha512-zJYu9ICC+mWF3+dJ4QC34N9RA0OVS1XtPbnf6oXlvGrLGNB8egsEzu/5wgG90I61hOOKvcywoLzwNmPqGAdATA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>
        <script type="module">
            import ColorHash from 'https://cdnjs.cloudflare.com/ajax/libs/color-hash/2.0.2/esm.min.js';
            window.ColorHash = ColorHash;
        </script>
        <script>
            var parsed_file = {
              sequences: null,
              selected_sequence: null,
            };

            var annotate_seq;
            var annotate_seq_name;
            const options = document.getElementById("sequence-list")
            var annotate_settings = {
              start: 0,
              width: 256,
              skip: 50,
              uri: "http://localhost:8080/predict",
            }

            const models = {}

            function predict_riboswitch_from_server() {
              seq = annotate_seq
              len = seq.length;
              n = Math.ceil((len - annotate_settings.start) / (annotate_settings.skip))
              m = 1

              annotations = []
              const colorHash = new ColorHash()

              function _continue_prediction(seq, m, n) {
                annotate_notif(annotate_seq_name, m, n)
                if (m > n) {
                  if (annotations.length < 1) {
                    notification("No riboswitch sequence found")
                  } else {
                    notification(`Found ${annotations.length} riboswitch sequences`)
                  }

                  viewer.setState({
                    annotations: annotations
                  })
                  return
                }

                s = seq.substring(0, annotate_settings.width)
                seq = seq.substring(annotate_settings.skip)

                axios.post(annotate_settings.uri, {
                  seq: s,
                })
                .then(function(r){
                  resp = r.data
                  if (resp.is_riboswitch) {
                    end = (m + 1)*(annotate_settings.skip) + annotate_settings.width
                    end = end > len ? len : end
                    annotations.push(
                      { name: resp.annotations, start: m * (annotate_settings.skip), end: end, direction: 1, color: colorHash.hex(resp.annotations) }  
                    )
                  }
                  _continue_prediction(seq, m+1, n)
                })
                .catch(
                  function(e) {
                    notification("Unable to annotate sequence.")
                    console.log(e)
                  }
                );
              }

              _continue_prediction(seq, m, n)
            }

            function notification(msg) {
              let element = document.createElement("toast")
              element.innerHTML = `<div id="toast" class="flex items-center p-4 m-1 w-full max-w-xs text-gray-100 bg-black rounded-lg shadow-lg " role="alert"> <div class="text-sm font-normal"> ${msg} </div> <div class="flex items-center ml-auto space-x-2"> <button type="button" class="close-btn bg-black text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex h-8 w-8" aria-label="Close" onclick="this.parentElement.parentElement.classList.add('hidden')" > <span class="sr-only">Close</span> <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg> </button> </div> </div>`;

              document.getElementById("toasts").appendChild(element);
              setTimeout(function() {
                element.remove()
              }, 15000);
            }

            function annotate_notif(name, m, n) {
              document.getElementById("annot-notif").classList.remove("hidden");
              document.getElementById("annot-text").innerText = !!m ? (`Annotating: ${name} - ${m} / ${n}`) : (`Annotating: ${name}`)

              if (m == 1) {
                notification(`Annotating <b>${name}</b>`)
              }

              if (m == n+1) {
                document.getElementById("annot-notif").classList.add("hidden");
                notification(`Completed annotating <b>${name}</b>`)
              }

            }

            async function parse_file() {
              if (file_input.files < 1) {
                return;
              }

              notification("Parsing file for sequences")
              options.classList.add("hidden");

              try {
                file_content =  await file_input.files.item(0).text()
                parsed_seq = await bioParsers.anyToJson(file_content)
                if (parsed_seq.length < 1) {
                  notification("No sequences found in the file.")
                  return;
                }

                parsed_file.sequences = []
                parsed_file.selected_sequence = null

                options.options.length = 1
                
                for (i = 0; i < parsed_seq.length; i++) {
                    s = parsed_seq[i];
                    n = s.parsedSequence.name.split(" ")[0]
                    
                    parsed_file.sequences.push({
                      name: n,
                      seq: s.parsedSequence.sequence,
                    });

                    options.add(new Option(`${i+1}. ${n}`, i))
                }

                notification(`Parsed ${parsed_seq.length} sequences.`);
                options.classList.remove("hidden");

              } catch(e) {
                notification("Failed to parse file.");
                console.log(e);
              }
            }

            function select_sequence() {
              seq_i = Number(options.value);
              parsed_file.selected_sequence = parsed_file.sequences[seq_i];

              notification(`Selected sequence: ${parsed_file.selected_sequence.name} for annotation. `)
            }

            async function annotate_sequence() {
              dna = dna_sequence_text.value.trim()
              name = 'Sequence'
              if (dna) {
                notification("Using sequence from text.")
              } else if (parsed_file.selected_sequence) {
                dna = parsed_file.selected_sequence.seq 
                name = parsed_file.selected_sequence.name
                notification("Using sequence from file.")
              } else {
                notification("No sequence to annotate.")
              }

              annotate_seq_name = name
              annotate_seq = dna

              annotate_notif(annotate_seq_name)

              viewer.setState({
                seq: dna,
                name: name,
                bpColors: { A: "#FF0000", T: "blue", 12: "#00FFFF" },
                annotations: [],
              })

              
              setTimeout(function() {
                predict_riboswitch()
              }, 10)

            }

            const viewer = window.seqviz.Viewer("root", 
                {
                    name: "L09136",
                    seq: "tcgcgcgtttcggtgatgacggtgaaaacctctgacacatgca",
                    style: { height: "500px"},
                    showPrimers: true,
                    showComplement: false,
                    showIndex: true,
                    viewer: "both",
                }
            );
            
            viewer.render();

            (async function () {
              models.detector = await tf.loadLayersModel('models/detector-js/model.json')
              models.classifier = await tf.loadLayersModel('models/classifier-js/model.json')
            })()

            function character_mapping(x) {
              mapping = {'R' : 'G', 'Y' : 'T', 'M' : 'A', 'K' : 'G', 'S' : 'G', 'W' : 'A', 'H' : 'A', 'B' : 'G', 'V' : 'G', 'D' : 'G'}

              x = x.toUpperCase()
              for (k in mapping) {
                x = x.replace(k, mapping[k])
              }

              return x.split('')
            }

            function letter_to_index(letter) {
              TOKEN_MAPPING = "ATGCN"
              for (i = 0; i < TOKEN_MAPPING.length; i++) {
                if (TOKEN_MAPPING[i] == letter) 
                  return i
              } 

              return null
            }

            function tokenize(i) {
              mapping = {'a': 1, 't': 2, 'g': 3, 'c': 4, 'n': 5}
              return mapping[i.toLowerCase()]
            }

            function pad_sequences(a, m) {
              if (a.length > m) {
                return a.slice(-m)
              } else {
                fill = Array(m - a.length).fill(0)
                return [...fill, ...a]
              }

            }

            function process_sequence(seq, for_classifier) {
              seq = character_mapping(seq)
              if (for_classifier) {
                seq = seq.map(letter_to_index)
              } else {
                seq = seq.map(tokenize)
              }

              return pad_sequences(seq, (for_classifier ? 250 : 256))
            }

            async function predict_detector(seq) {
              seq = tf.tensor2d([process_sequence(seq)])
              p = await models.detector.predict(seq)
              p = (await p.array())[0]
              f = p[0], t = p[1]
              
              return {
                is_riboswitch: t > f,
                annotations: null,
                confidence: ((t > f ? t : f) * 100).toFixed(),
              }
            }

            async function predict_classifier(seq) {
              seq = tf.tensor2d([process_sequence(seq, true)])
              p = await models.classifier.predict(seq)
              p = (await p.array())[0]

              c = p.indexOf(Math.max(...p))
              
              return {
                is_riboswitch: true,
                annotations: `Ribo-${c}`,
                confidence: (p[c] * 100).toFixed(),
              }
            }

            async function predict_ribo_fn(seq) {
              det = await predict_detector(seq)
              
              if (det.is_riboswitch) {
                return await predict_classifier(seq)
              } else 
                return det
            }

            function predict_riboswitch() {
              seq = annotate_seq
              len = seq.length;
              n = Math.ceil((len - annotate_settings.start) / (annotate_settings.skip))
              m = 1

              annotations = []
              const colorHash = new ColorHash()

              async function _continue_prediction(seq, m, n, start) {
                annotate_notif(annotate_seq_name, m, n)
                console.log("called annotate_notif")
                if (m > n) {
                  console.log(annotations.length, annotations)
                  if (annotations.length < 1) {
                    notification("No riboswitch sequence found")
                  } else {
                    notification(`Found ${annotations.length} riboswitch sequences`)
                  }

                  viewer.setState({
                    annotations: annotations
                  })
                  return
                }

                s = seq.substring(0, annotate_settings.width)
                seq = seq.substring(annotate_settings.skip)

                predict_ribo_fn(s)
                .then(function(r){
                  resp = r
                  console.log("resp", resp)
                  if (resp.is_riboswitch) {
                    end = start + annotate_settings.width
                    end = end > len ? len : end

                    annotations.push(
                      { name: resp.annotations, start:start, end: end, direction: 1, color: colorHash.hex(resp.annotations) }  
                    )
                  }
                  setTimeout(function() {
                    _continue_prediction(seq, m+1, n, start + annotate_settings.skip)
                  }, 1)
                })
                .catch(
                  function(e) {
                    notification("Unable to annotate sequence.")
                    console.log(e)
                  }
                );
              }

              setTimeout(function() {
                _continue_prediction(seq, m, n, 0)
              }, 1)
            }

        </script>
    
</body></html>
